<mvc:View
  controllerName="sap.audit.controller.Detail"
  xmlns="sap.m"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns:f="sap.f"
  xmlns:core="sap.ui.core"
  xmlns:layout="sap.ui.layout">
  
  <Page
    title="{i18n>logDetailsTitle}"
    showNavButton="true"
    navButtonPress=".onNavBack">
    
    <f:DynamicPage id="dynamicPageId" headerExpanded="true">
      <f:title>
        <f:DynamicPageTitle>
          <f:heading>
            <Title text="{i18n>logDetailsTitle}" />
          </f:heading>
          <f:snappedContent>
            <Text text="{
              parts: [
                {path: 'logDetails>/entity'},
                {path: 'logDetails>/operation'}
              ],
              formatter: '.formatter.formatTitleInfo'
            }" />
          </f:snappedContent>
          <f:expandedContent>
            <Text text="{
              parts: [
                {path: 'logDetails>/entity'},
                {path: 'logDetails>/operation'},
                {path: 'logDetails>/timestamp', formatter: '.formatter.formatDateTime'}
              ],
              formatter: '.formatter.formatDetailedInfo'
            }" />
          </f:expandedContent>
        </f:DynamicPageTitle>
      </f:title>
      
      <f:content>
        <IconTabBar id="idIconTabBar" expanded="true" class="sapUiResponsiveContentPadding">
          <items>
            <IconTabFilter
              key="info"
              text="{i18n>generalInfoTab}"
              icon="sap-icon://hint">
              <layout:VerticalLayout width="100%">
                <layout:content>
                  <layout:HorizontalLayout>
                    <layout:VerticalLayout class="sapUiMediumMarginEnd">
                      <ObjectAttribute title="{i18n>timestampLabel}" text="{
                        path: 'logDetails>/timestamp',
                        formatter: '.formatter.formatDateTime'
                      }" />
                      <ObjectAttribute title="{i18n>userLabel}" text="{logDetails>/user}" />
                      <ObjectAttribute title="{i18n>operationLabel}" text="{logDetails>/operation}" />
                    </layout:VerticalLayout>
                    
                    <layout:VerticalLayout>
                      <ObjectAttribute title="{i18n>entityLabel}" text="{logDetails>/entity}" />
                      <ObjectAttribute title="{i18n>statusLabel}">
                        <ObjectStatus
                          text="{= ${logDetails>/success} ? ${i18n>successStatus} : ${i18n>failureStatus} }"
                          state="{= ${logDetails>/success} ? 'Success' : 'Error' }" />
                      </ObjectAttribute>
                    </layout:VerticalLayout>
                  </layout:HorizontalLayout>
                </layout:content>
              </layout:VerticalLayout>
            </IconTabFilter>
            
            <IconTabFilter
              key="data"
              text="{i18n>dataTab}"
              icon="sap-icon://request"
              visible="{= !!${logDetails>/data}}">
              <VBox>
                <Text text="{i18n>requestDataLabel}" class="sapUiSmallMarginBottom" />
                <CodeEditor
                  editable="false"
                  height="300px"
                  width="100%"
                  type="json"
                  value="{
                    path: 'logDetails>/data',
                    formatter: '.formatter.formatJSON'
                  }" />
              </VBox>
            </IconTabFilter>
            
            <IconTabFilter
              key="original"
              text="{i18n>originalDataTab}"
              icon="sap-icon://document"
              visible="{= !!${logDetails>/originalData}}">
              <VBox>
                <Text text="{i18n>originalDataLabel}" class="sapUiSmallMarginBottom" />
                <CodeEditor
                  editable="false"
                  height="300px"
                  width="100%"
                  type="json"
                  value="{
                    path: 'logDetails>/originalData',
                    formatter: '.formatter.formatJSON'
                  }" />
              </VBox>
            </IconTabFilter>
            
            <IconTabFilter
              key="changes"
              text="{i18n>changesTab}"
              icon="sap-icon://edit"
              visible="{= !!${logDetails>/changes}}">
              <VBox>
                <Text text="{i18n>changesLabel}" class="sapUiSmallMarginBottom" />
                <CodeEditor
                  editable="false"
                  height="300px"
                  width="100%"
                  type="json"
                  value="{
                    path: 'logDetails>/changes',
                    formatter: '.formatter.formatJSON'
                  }" />
              </VBox>
            </IconTabFilter>
            
            <IconTabFilter
              key="result"
              text="{i18n>resultTab}"
              icon="sap-icon://response"
              visible="{= !!${logDetails>/result}}">
              <VBox>
                <Text text="{i18n>resultDataLabel}" class="sapUiSmallMarginBottom" />
                <CodeEditor
                  editable="false"
                  height="300px"
                  width="100%"
                  type="json"
                  value="{
                    path: 'logDetails>/result',
                    formatter: '.formatter.formatJSON'
                  }" />
              </VBox>
            </IconTabFilter>
          </items>
        </IconTabBar>
      </f:content>
    </f:DynamicPage>
  </Page>
</mvc:View> 